<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sistema de Puntos - Registro</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css"
    />

    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css"
    />
    <link rel="stylesheet" href="css/estilo.css" />
    <link
      rel="stylesheet"
      type="text/css"
      href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css"
    />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.7.7/dist/css/tempus-dominus.min.css"
    />
  </head>
  <!-- 🔒 Botón de cerrar sesión flotante -->
  <a href="#" id="logout" class="logout-icon logged-in" title="Cerrar sesión">
    <i class="fas fa-sign-out-alt"></i>
  </a>
  <body>
    <div class="background-image"></div>
    <div>
      <div class="logo-container">
        <img id="logoImage" src="img/LOGO MONTO.png" alt="Logo" />
      </div>
      <div>
        <div class="row">
          <div class="col-md-6 offset-md-3">
            <ul class="list-group posts"></ul>
          </div>
        </div>
      </div>

      <!-- 🔹 Contenedor de botones -->
      <div class="auth-buttons-container">
        <a
          href="#"
          class="auth-button logged-out"
          data-bs-toggle="modal"
          data-bs-target="#signinModal"
        >
          Iniciar sesión
        </a>
        <a
          href="#"
          class="auth-button logged-out"
          data-bs-toggle="modal"
          data-bs-target="#signupModal"
        >
          Registrarse
        </a>
        <!-- <a href="#" class="auth-button logged-in" id="logout">Cerrar sesión</a>-->
      </div>
      <!-- 🔹 Botón para abrir el Menú -->
      <div class="menu-button-container">
        <a href="#" type="button" class="menu-button" id="openMenu"> Menú </a>
      </div>
      <!-- 🔹 Botones de redes sociales -->
      <div class="social-buttons-container">
        <a
          href="https://www.instagram.com/mister.donut?utm_source=ig_web_button_share_sheet&igsh=ZDNlZDc0MzIxNw=="
          rel="noopener"
          target="_blank"
          title="Síguenos en Instagram"
          class="social-button instagram"
        >
          <i class="fab fa-instagram"></i>
        </a>
        <a
          href="https://www.facebook.com/profile.php?id=61566335092408"
          rel="noopener"
          target="_blank"
          class="social-button facebook"
          title="Síguenos en facebook"
        >
          <i class="fab fa-facebook-f"></i>
        </a>
        <a
          href="https://wa.me/5535186613"
          rel="noopener"
          target="_blank"
          title="Envíanos mensaje por whatsapp"
          class="social-button whatsapp"
        >
          <i class="fab fa-whatsapp"></i>
        </a>
        <a
          href="https://web.didiglobal.com/mx/food/ciudad-de-mexico-cdmx/mr-donut/5764607669739192702/"
          rel="noopener"
          target="_blank"
          title="Pedir por Didi Food"
          class="delivery-button"
        >
          <img src="./img/icono_didiFood.png" alt="Didi Food" />
        </a>
      </div>
      <!-- 🔸 Sección de apps de delivery -->
      <div class="delivery-apps-container">
        <!-- Ejemplo futuro para Uber Eats y Rappi -->
        <!--
  <a href="#" class="delivery-button uber" title="Pedir por Uber Eats">
    <img src="./img/icono_uber.png" alt="Uber Eats" />
  </a>
  <a href="#" class="delivery-button rappi" title="Pedir por Rappi">
    <img src="./img/icono_rappi.png" alt="Rappi" />
  </a>
  -->
      </div>
    </div>
    <!-- 🔹 Modal con Carrusel -->
    <div class="modal fade" id="menuModal" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-lg">
        <div class="modal-content">
          <div class="modal-body">
            <div class="modal-header">
              <button
                type="button"
                class="btn-close"
                data-bs-dismiss="modal"
                aria-label="Cerrar"
              ></button>
            </div>
            <!-- 🔹 Carrusel de Bootstrap -->
            <div id="menuCarousel" class="carousel slide" data-bs-touch="false">
              <div class="carousel-inner" id="carouselInner"></div>

              <!-- 🔹 Controles del carrusel -->
              <button
                class="carousel-control-prev"
                type="button"
                data-bs-target="#menuCarousel"
                data-bs-slide="prev"
              >
                <span
                  class="carousel-control-prev-icon"
                  aria-hidden="true"
                ></span>
              </button>
              <button
                class="carousel-control-next"
                type="button"
                data-bs-target="#menuCarousel"
                data-bs-slide="next"
              >
                <span
                  class="carousel-control-next-icon"
                  aria-hidden="true"
                ></span>
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!--Modal forms-->
    <div
      class="modal fade"
      id="signupModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalSignup"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Registro</h3>
            <button
              type="button"
              class="btn-close btn-close-black"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="signup-form">
              <div>
                <label for="nombre">Nombre:</label>
                <input
                  type="text"
                  id="nombre"
                  class="form-control mb-3t"
                  placeholder="Nombre completo"
                  required
                />
              </div>
              <div>
                <label for="telefonoRegistro">Telefono:</label>
                <input
                  type="phone"
                  id="telefonoRegistro"
                  class="form-control mb-3t"
                  placeholder="5545458585"
                  required
                />
              </div>
              <span id="mensajeErrorTelefono"></span>
              <div>
                <label for="alcaldia">Alcaldia o Municipio:</label>
                <input
                  type="text"
                  id="alcaldia"
                  class="form-control mb-3t"
                  required
                />
              </div>
              <div>
                <label for="colonia">Colonia:</label>
                <input
                  type="text"
                  id="colonia"
                  class="form-control mb-3t"
                  required
                />
              </div>
              <div>
                <label for="nacimiento">Fecha de nacimiento:</label>
                <div class="input-group">
                  <input
                    type="text"
                    id="nacimiento"
                    class="form-control mb-3t"
                    placeholder="dd/mm/aaaa"
                    required
                    data-td-target="#nacimiento"
                  />
                </div>
              </div>
              <span id="mensajeErrorNacimiento"></span>
              <div>
                <label for="email">Correo electrónico:</label>
                <input
                  type="email"
                  id="email"
                  class="form-control mb-3t"
                  placeholder="email@ejemplo.com"
                  required
                />
              </div>
              <span id="mensajeErrorEmail"></span>
              <div>
                <label for="password">Contraseña:</label>
                <input
                  type="password"
                  id="password"
                  class="form-control mb-3t"
                  placeholder="Contraseña"
                  required
                />
              </div>
              <div>
                <label for="confirmPassword">Confirmar contraseña:</label>
                <input
                  type="password"
                  id="confirmPassword"
                  placeholder="Confirme contraseña"
                  class="form-control mb-3t"
                  required
                />
              </div>
              <span id="mensajeErrorPassword" class="help-block"></span>
              <div class="button-container">
                <button type="submit" id="registroButton">Registrarse</button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Modal iniciar sesion-->
    <div
      class="modal fade"
      id="signinModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalSignin"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Inicio Sesión</h3>
            <button
              type="button"
              class="btn-close btn-close-black"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="login-form">
              <label for="email">Correo Electronico</label>
              <input
                type="email"
                id="login-email"
                class="form-control mb-3"
                placeholder="Correo electronico"
                required
              />
              <label for="password">Contraseña</label>
              <input
                type="password"
                id="login-password"
                class="form-control mb-3"
                placeholder="Contraseña minimo 6 caracteres"
                required
              />

              <button type="submit" class="btn btn-success w-100 mb-4">
                Ingresar
              </button>
              <strong
                ><p>
                  Si nuestro personal lo ha registrado, por favor inicie sesión
                  con su número celular
                </p></strong
              >
              <div class="btn-container-telefono">
                <button
                  type="button"
                  class="btn-telefono"
                  data-bs-toggle="modal"
                  data-bs-target="#signinModalTelefono"
                >
                  <i class="fas fa-phone-alt me-2"></i>Telefono
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Modal validar telefono-->
    <div
      class="modal fade"
      id="signinModalTelefono"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalSigninTelefono"
    >
      <div class="modal-dialog" id="validarTelefonoDiv">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Validar teléfono</h3>
            <button
              type="button"
              class="btn-close btn-close-black"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="telefono-form">
              <label for="telefono">Teléfono:</label>
              <input
                type="phone"
                id="telefono"
                class="form-control mb-3"
                value="+52"
                placeholder="+521234567898"
                required
              />
              <div id="recaptcha-container"></div>
              <button
                type="submit"
                id="signinTelefonobtn"
                class="btn btn-success w-100 mb-4"
              >
                Enviar código
              </button>
            </form>
          </div>
        </div>
      </div>
    </div>
    <!-- Modal validar codigo-->
    <div
      class="modal fade"
      id="codigoModal"
      tabindex="-1"
      role="dialog"
      aria-labelledby="exampleModalSigninCodigo"
    >
      <div class="modal-dialog" id="validarCodigoDiv">
        <div class="modal-content">
          <div class="modal-header">
            <h3>Validar Codigo</h3>
            <button
              type="button"
              class="btn-close btn-close-black"
              data-bs-dismiss="modal"
              aria-label="Close"
            ></button>
          </div>
          <div class="modal-body">
            <form id="codigo-form">
              <label for="codigo">Codigo:</label>
              <input
                type="tel"
                id="codigo"
                class="form-control mb-3"
                required
              />
              <button type="submit" class="btn btn-success w-100 mb-4">
                Validar código
              </button>
              <a
                >si no recibe ningun codigo en 30s vuelva a cargar la pagina e
                intentelo de nuevo</a
              >
            </form>
          </div>
        </div>
      </div>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.6/dist/umd/popper.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.7.7/dist/js/tempus-dominus.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@eonasdan/tempus-dominus@6.7.7/dist/locales/es.js"></script>
    <script>
      // Función mejorada para inicializar Tempus Dominus
      function initTempusDominus() {
        const signupModal = document.getElementById("signupModal");

        if (!signupModal) return;

        // Inicializa solo cuando el modal se muestra
        signupModal.addEventListener("shown.bs.modal", function () {
          const nacimientoField = document.getElementById("nacimiento");

          if (!nacimientoField || nacimientoField._picker) return;

          try {
            // Añadimos estilos para las flechas
            const style = document.createElement("style");
            style.textContent = `
              .tempus-dominus-widget .toolbar .chevron-container::before {
                font-family: 'bootstrap-icons';
                content: "\\F284"; /* Icono de flecha izquierda */
                font-size: 1.5rem;
              }
              .tempus-dominus-widget .toolbar .chevron-container.chevron-next::before {
                content: "\\F285"; /* Icono de flecha derecha */
              }
            `;
            document.head.appendChild(style);

            const picker = new tempusDominus.TempusDominus(nacimientoField, {
              localization: {
                locale: "es",
                format: "yyyy-dd-MM",
              },
              display: {
                icons: {
                  previous: "bi bi-chevron-left",
                  next: "bi bi-chevron-right"
                },
                theme: "dark",
                viewMode: "years", // Inicia en selección de año
                components: {
                  decades: true,
                  year: true,
                  month: true,
                  date: true,
                  hours: false,
                  minutes: false,
                  seconds: false,
                },
                buttons: {
                  today: false,
                  clear: false,
                  close: true,
                },

                theme: window.innerWidth < 768 ? "light" : "auto",
              },
              restrictions: {
                maxDate: new Date(
                  new Date().setFullYear(new Date().getFullYear() - 16)
                ),
                minDate: new Date(1950, 0, 1), // Año mínimo 1950
              },
              defaultDate: new Date(1990, 0, 1), // Fecha por defecto en el medio del rango
              viewDate: new Date(2000, 0, 1), // Vista inicial centrada en 1980
            });

            // Marca el campo como inicializado
            nacimientoField._picker = true;

            // Ajustes específicos para móviles
            if (window.innerWidth < 768) {
              const pickerElement = picker._element;
              pickerElement.style.fontSize = "14px";
            }
          } catch (error) {
            console.error("Error al inicializar Tempus Dominus:", error);
          }
        });

        // También inicializa si el modal ya está abierto al cargar
        if (signupModal.classList.contains("show")) {
          const event = new Event("shown.bs.modal");
          signupModal.dispatchEvent(event);
        }
      }

      // Inicialización segura cuando todo esté listo
      document.addEventListener("DOMContentLoaded", function () {
        // Verifica si Tempus Dominus está cargado
        if (typeof tempusDominus === "undefined") {
          console.error("Tempus Dominus no está cargado correctamente");
          return;
        }

        initTempusDominus();
      });

      // Maneja posibles redimensionamientos
      window.addEventListener("resize", function () {
        const pickerInstance = document.getElementById("nacimiento")?._picker;
        if (pickerInstance) {
          pickerInstance.updateOptions({
            display: {
              theme: window.innerWidth < 768 ? "light" : "auto",
            },
          });
        }
      });
    </script>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
    <script
      type="text/javascript"
      src="https://cdn.jsdelivr.net/npm/toastify-js"
    ></script>
    <!-- Librería para hacer zoom en imágenes -->
    <script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrious/4.0.2/qrious.min.js"></script>
    <script type="module" src="./main.js"></script>
    <footer>
      <p>Sistema de Puntos - Mr. Donut | Todos los derechos reservados</p>
    </footer>
  </body>
</html>
